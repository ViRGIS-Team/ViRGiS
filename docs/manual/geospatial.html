<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>&#8203;3D Geospatial Systems | ViRGIS VR GIS </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="&#8203;3D Geospatial Systems | ViRGIS VR GIS ">
    <meta name="generator" content="docfx 2.54.0.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="3d-geospatial-systems">​3D Geospatial Systems</h1>

<h2 id="purpose">​Purpose</h2>
<p>The purpose of this section is to provide some background and discussion into the complications of 3D Geospatial Systems and the design decisions being made.</p>
<p>Read this section to get a deeper understanding of the reasoning behind some of the design decisions made in the ViRGIS App.</p>
<h2 id="sources">​Sources</h2>
<p>The following are some of the sources for this discussion</p>
<p>Tet-Khuan, C., Rahman, A.A. &amp; Zlatanova, S. (2007) 3D spatial operations in geo DBMS environment for 3D GIS. In: <em>ResearchGate</em>. 26 August 2007 pp. 151–163.</p>
<p>Laksono, D. &amp; Aditya, T. (2019) Utilizing A Game Engine for Interactive 3D Topographic Data Visualization. <em>ISPRS International Journal of Geo-Information</em>. 8 (8), 361.</p>
<p>De Roo, B., Bourgeois, J. &amp; De Maeyer, P. (2017) Usability Assessment of a Virtual Globe-Based 4D Archaeological GIS. In: Alias Abdul-Rahman (ed.). <em>Advances in 3D Geoinformation</em>. Cham, Springer International Publishing. pp. 323–335.</p>
<p>De Roo, B. (2016) A GEODATA INFRASTRUCTURE FOR ARCHAEOLOGY: FLEXIBILITY IN MANAGEMENT AND ANALYSIS. In: <em>ResearchGate</em>. [Online]. 28 June 2016 Available from: doi:10.5593/SGEM2016/B21/S08.071 [Accessed: 22 March 2020].</p>
<p>van Oosterom, P., Martinez-Rubi, O., Tijssen, T. &amp; Gonçalves, R. (2017) Realistic Benchmarks for Point Cloud Data Management Systems. In: Alias Abdul-Rahman (ed.). <em>Advances in 3D Geoinformation</em>. Cham, Springer International Publishing. pp. 1–30.</p>
<p>Rahman, A.A., Karim, H., Jamali, A., Buyuksalih, G., et al. (2018) Conceptual Framework Towards Unified 3D Topological Modelling and Visualization Based on CityGML. In: <em>ResearchGate</em>. [Online]. 1 May 2018 Available from: <a href="https://www.researchgate.net/publication/323382865_Conceptual_Framework_Towards_Unified_3D_Topological_Modelling_and_Visualization_Based_on_CityGML">https://www.researchgate.net/publication/323382865_Conceptual_Framework_Towards_Unified_3D_Topological_Modelling_and_Visualization_Based_on_CityGML</a> [Accessed: 22 March 2020].</p>
<p>Nicholas Duggan FRGS Cgeog (GIS) (2015) “Why 3D GIS is the Future”: <a href="https://www.xyht.com/spatial-itgis/3d-gis-future/">https://www.xyht.com/spatial-itgis/3d-gis-future/</a></p>
<p>Martin Dobias (2019) New QGIS 3D capabilities and future plans reviewed in <a href="https://hub.packtpub.com/new-qgis-3d-capabilities-and-future-plans-presented-by-martin-dobias-a-core-qgis-developer/">https://hub.packtpub.com/new-qgis-3d-capabilities-and-future-plans-presented-by-martin-dobias-a-core-qgis-developer/</a></p>
<p>De Roo, B., Bourgeois, J. &amp; De Maeyer, P. (2017) Usability Assessment of a Virtual Globe-Based 4D Archaeological GIS. In: Alias Abdul-Rahman (ed.). <em>Advances in 3D Geoinformation</em>. Cham, Springer International Publishing. pp. 323–335.</p>
<h2 id="some-terminology-and-realms">​Some Terminology and Realms</h2>
<p><strong>Real-World Space</strong> - space defined by geographic coordinates and by real-world units (e.g. metres). This space is always projected and z-up.</p>
<p><strong>VR-Space</strong> - space defined in the virtual world in the coordinate system of the VR world. This is an unprojected coordinate system and y-up.</p>
<p><strong>GIS World</strong> - refers to the paradigm space of Geospatial Information and the tools and processes used there.</p>
<p><strong>VR World</strong> - refers to the paradigm space of the VR and gaming systems and the tools and processes used there.</p>
<p><strong>World Space Coordinates</strong> - refers to the Unity World Space Coordinate System</p>
<h2 id="geometry">​Geometry</h2>
<p>ToDo - expand, confirm and correct</p>
<p>ViRGIS creates a limited extent geographically projected coordinate system in the VR Space, where the ellipsoid is represented as a planar datum. This tool is intended for limited extent GIS or Spatial analysis problems where the planar datum is not a problem. If an ellipsoid representation of the datum is required, this is not the tool.</p>
<p>This space can be zoomed - that really represents a change in the level of details (LoD) but also changes the base relationship between VR Space units and Real World Space units (which is a nominal 1m per unit but changes as the zoom level change to try to avoid impossibly large numbers in the VR Space).</p>
<p>Real-world Points, Lines and Polygons etc are projected into this VR Space using standard projection techniques.</p>
<h2 id="basics---moving-from-2d-to-3d">​Basics - moving from 2D to 3D</h2>
<ol>
<li><strong>Coordinate systems don’t change.</strong> We continue to use the same Coordinate Reference Systems and datums. With all of the same tools needed and problems associated.</li>
<li><p><strong>Altitudes are not Always Altitudes</strong>. Z, or more traditionally Altitude, has always been used in GIS but has not been a core coordinate and as such the handling is less well defined. Z can be:</p>
<ol>
<li>Relative to the Ellipsoid,</li>
<li>Relative to the Geoid,</li>
<li>Relative to local ground level or a dedicated local datum,</li>
<li><p>Relative to a regional datum such as MSL.</p>
<p>In 2D GIS, in most cases Z is just a DEM (i.e. an attribute), so this did not matter and since Z is a data attribute and not actually a coordinate, if the data is wrong or missing it does not change the geometry. This is not true in true 3D space. </p>
<p>In the VR World, all Z values from the Real-World Space are projected into Y values in the VR Space coordinate system relative to the ellipsoid (ToDO - confirm this).</p>
</li>
</ol>
</li>
<li><strong>Points are Points.</strong> A point (with Z value) is a simple 3D entity. No difference there.</li>
</ol>
<p>2D points - i.e. LatLngs - have to be dealt with since they are valid data points in the GIS formats used. The current assumption will be to place these points on the ellipsoid. The preferred approach is to deal with these points in the data acquisition phase and in the GIS - basically to give all points valid Z values before they get to the VR Space. </p>
<p>There are some additional types of symbology. Using the experience quoted by QGIS 3D, a good starting point is:</p>
<ul>
<li>Basic shape and colour. The basic shapes in Unity are sphere (actually ellipsoid since it can be scaled in each dimension), cube (actually right cuboid since it can be scaled in each dimension) &amp; right elliptical cylinder and the colours are defined by a standard RGBA color space. So - we shall start with that.</li>
<li>Using 3D models (i.e. meshes) as 3D icons. This capability is practically OOTB with Unity, but providing the library of Icons and semantics to define them in the Project.json will take some time.</li>
<li>Billboards. I.e. 2D sprites that always face the viewer. Creating Text based Billboards is simple in Unity and will be used in ViRGIS V1 for labelling. Adding texture should not be complicated but has the same problem of library and semantics as b).</li>
<li><strong>Lines remain Lines</strong>. A line is a set of points or vertices and, provided all vertices have a Z value, is a simple 3D entity although it should be noted for completeness that the length of the line measured in 3D may not be the same as the length of the line measured in 2D.</li>
</ul>
<p>The symbology questions are primarily:</p>
<ul>
<li>“Simple” or “Buffered” - i.e. whether the width is defined in VR-World units or in Real-World Units and projected to VR-World units. </li>
<li><p>Shape. In the VR-World (more so than the 3D GIS World) every entity needs solid structure for the brain to process it correctly. Lines with zero breadth don’t work. Therefore, all lines will be represented by cuboids or right elliptical cylinders. </p>
<p>  As a note, the line segment is created by elongating the mesh along the z-axis in VR Space. That means the characteristics of the line symbology (i.e. cross section) are set by the X and Y values of the scale vector in VR Space. To keep consistency, the scaling is still written as a 3D transform in z-up format. This means that in the project.json file, the x and z values set the width and breadth of the line. The y value should always be 1, since the y-value is created when drawing the line.</p>
</li>
</ul>
<pre><code>It should also be noted that the transform is applied in the local reference frame. This means that the (Real-World) y axis is aligned along the line segment and the other axes aligned accordingly. This actually means that the (Real-world) y axis could actually end up pointing in any direction in Real-World global space, including down.
</code></pre><ol>
<li><p><strong>Polygons are difficult</strong>. As discussed in Tet-Khuan et al and elsewhere, Polygons are not actually 3D shapes and a number of assumptions have to be made:</p>
<ol>
<li><p>The assumption in 2D GIS is that a polygon is planar and orthogonal to the view (i.e. that all vertices have the same Z value). It is possible create this polygon in the VR Space either :</p>
<ol>
<li>As a 2D Mesh, or</li>
<li><p>As a prism whose cross section is the polygon.</p>
<p>For ViRGIS, we have not used either of these methods. We have assumed that solid bodies, such as might be represented by approach ii) will come into the App as either a group of polygons or as a mesh. These two statements are functional the same as described below but have different meanings in term of the formats used. A group of polygons might be represented by a GeoJSON file while a mesh is more likely to be presented as a .OBJ file etc.</p>
</li>
</ol>
</li>
<li><p>It is possible to construct a polygon with 3D points. This is sometimes called a polygonZ and is assumed to be planar. Due to projection, the shape of this polygon might not the same as the shape seen in 2D GIS.</p>
</li>
<li><p>If it is not planar, it is a polyhedral.</p>
<p>For features presenting as polygons, we have chosen the following method</p>
</li>
</ol>
</li>
</ol>
<ul>
<li>A Polygon is represented by a linear ring as defined in GeoJSON, </li>
<li>There are no constraints on the Z values of the vertices and no assumptions that the Polygon is planar,</li>
<li>A simplistic algorithm is used to turn a linear ring into a polyhedral by adding a single additional vertex at the centroid of the  linear ring,</li>
<li>This polyhedral is turned into a triangulated mesh;  note that for a planar polygon, the polygon will at this point still be planar but represented by a triangulated mesh rather than a polygon,</li>
<li>The polyhedral can now be manipulated by moving any of vertices.</li>
<li>The polyhedral is returned back to the GIS world by returning the linear ring. This will then be projected into the 2D GIS world automatically, since that world will ignore the z values as coordinates and just use the x and y values.</li>
<li>The polyhedron vertex is stored in the metadata for the polygon so round trip editing capabilities between the GIS World and the VR World are ensured.</li>
</ul>
<p>This means that all polygons become internally just a special case of a mesh.  </p>
<p>For symbology, the mesh needs to be constructed from a material that is covered with a texture. This texture can be computed, e.g. flat or cross-checked, where the color and possible other parameters have to be configured, or it can be a link to an image in .PNG or .JPEG format.</p>
<p>One characteristic of a polygon over a mesh is the linear ring - which can take symbology as well. This allows the edges in a polygon mesh to be high-lighted. This is not simply possible in a standard Unity mesh.</p>
<ol>
<li><strong>Meshes are New</strong>. In the VR World, meshes become a very important feature type. Meshes are 2.xD surfaces made up of small planar polygons joined at the edges with a large number of vertices.</li>
</ol>
<p>[ToDO - more research on the use of mesh in GIS] </p>
<p>In Unity, meshes can have triangular or quad faces, but for performance and greater consistency with the GIS TIN formats, we will only be using triangulated meshes. </p>
<p>ViRGIS V1 will include arbitrary meshes as georeferenced objects in the model and allow the position, scale and rotation of the mesh to be manipulated.</p>
<p>ViRGIS v1 assumes that, for meshes coming from “non-polygon” formats (e.g..OBJ), all data about the material, texture and colour of the mesh is included in the mesh data and no additional symbology is provided.</p>
<p>Each mesh definition file (which may contain one or more individual meshes) is created in the model as its own <code>RecordSet</code> object or GIS layer.</p>
<ol>
<li><strong>Point Clouds are New</strong>. A point cloud is a large set of 3D points each of which has attributes (e.g. colour) and together make up some structure. The key point here is the size of the dataset. </li>
</ol>
<p>Point Clouds are important for LiDAR analysis and for Photogrammetry.</p>
<p>ViRGIS V1 loads Point Cloud data into a Unity Particle system to provide a performant way of presenting very large numbers of points in the VR World.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/runette/ViRGIS/blob/gh-pages/Documentation/manual/geospatial.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            ViRGIS VR GIS
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
